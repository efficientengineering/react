name: 'Setup Node Job'
description: 'Checkout code, setup node, restore cache and install dependencies'
inputs:
  node-version:
    description: 'Node version'
    required: false
    default: '18.20.1'
  node-version-file:
    description: 'Node version file'
    required: false
  cache-dependency-path:
    description: 'Path to the dependency lock file'
    required: true
    default: 'yarn.lock'
  skip-electron-download:
    description: 'Optional environment variable for skipping electron download'
    required: false
    default: ''
runs:
  using: "composite"
  steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-node@v4
      with:
        node-version: ${{ inputs.node-version }}
        node-version-file: ${{ inputs.node-version-file }}
        cache: yarn
        cache-dependency-path: ${{ inputs.cache-dependency-path }}
    - name: Restore cached node_modules
      uses: actions/cache@v4
      with:
        path: "**/node_modules"
        key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles(inputs.cache-dependency-path) }}
    - run: yarn install --frozen-lockfile
      env:
        ELECTRON_SKIP_BINARY_DOWNLOAD: ${{ inputs.skip-electron-download }}